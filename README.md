## 回測 IPO 上市股票的最佳投資持有時間：基於不同產業的研究 

### 研究方法概述 

> 本研究旨在通過程式化回測分析不同產業IPO股票的最佳持有期，以期找出持有期與最大收益之間的關聯。研究的整體流程如下： 

#### 系統架構 
- 使用語言為`python`，版本為`3.9+`，結合API應用並配合`Pandas`進行數據處理，再以`Matplotlib`進行數據可視化。
- 前置作業：準備公司清單等。
- 數據蒐集模組
  - 讀取IPO股票名單和股名字典。
  - 通過API接口從TWSE獲取與合併股票的歷史交易數據。(可處理多個月數據)
  - 處理上市日期的格式轉換。
- 資料前處理
- 報酬率計算模組
  - 主要IO格式為DataFrame。
  - 計算每日、每周、每月、每季度和半年報酬率。
  - 可將結果輸出為CSV文件。
- 產業分析模組
  - 主要IO格式為DataFrame。
  - 依產業別分組後，利用每日、每周、每月、每季度和半年報酬率計算標準差等統計資訊。
  - 具備結果可視化功能，更利於人類分析。
  - 可將結果輸出為CSV文件。

<div style="page-break-after: always;"></div>

#### 流程圖

![流程圖-1](https://github.com/user-attachments/assets/754779c6-fc83-469c-a3a1-458f0eb37e2d)



#### 前置作業

1. 於證交所下載`ipo公司清單`，並將
   - `公司代號`標記為`symbol`
   - `上市日期`標記為`Listing date`
2. 儲存為`new_listing.csv`文件。
3. 製作股票代號及股票名稱對應的`code3.csv`文件，方便後續檢查。 

#### 數據蒐集

- 使用台灣證券交易所（TWSE）的API取得歷史交易數據，每次請求獲取一個月的數據，直到獲取到足夠的數據（例如180天的數據）。
1. 依據上市日期和股票代號，收集各IPO股票的日交易數據
   - 根據提供的`new_listing.csv`文件中的上市日期和股票代號進行數據收集。 
2. 將數據轉換為`DataFrame`型別，進行清洗和格式轉換。 

#### 資料前處理 
- 使用`Pandas`進行數據的異常值清理與標準化作業： 
  - 剔除無效或不完整的數值，確保後續作業結果正常。
  - 將民國年日期轉換為西元年日期，確保日期格式一致。

#### 報酬率計算
  - 計算上述數據資料的日、周、月、季以及半年報酬率作為回測結果。
  - 將回測結果輸出為CSV文件。 

#### 產業分析：
  - 讀取報酬率CSV文件，並使用`Pandas`將其轉換為`DataFrame`進行處理。
  - 根據產業對數據進行分組計算，計算每個產業在不同持有期內的平均報酬率和標準差，並統計樣本數。

#### 結果可視化： 

   - 使用`Matplotlib`繪製圖表，展示各產業在不同持有期內的平均報酬率及其標準差，可直觀分析結果。
   - 將統計結果輸出為新的`CSV`文件，便於後續的深入分析和報告撰寫。 

![alt text](<a day_mean_std_sorted-1.png>)
![alt text](<a week_mean_std_sorted-1.png>)
![alt text](<a month_mean_std_sorted-2.png>)
![alt text](<one season_mean_std_sorted-1.png>)
![alt text](<half a year_mean_std_sorted-1.png>)

#### 結果分析
- 總體概況： 我們對多個產業的IPO股票在不同持有期（當日、一週、一個月、一季、半年）內的平均報酬率及標準差進行了回測分析，以探討最佳投資持有時間。

- 行業表現分析：

- 紡織纖維

  - 當日平均報酬率為0.29%，半年平均報酬率為9.77%，顯示出長期持有的增值潛力。但波動性也隨之增加，標準差為6.18%。

- 資訊服務業

  - 當日平均報酬率為0.17%，一個月平均報酬率顯著提升至12.02%，而半年平均報酬率達到23.08%，表明該行業在長期持有中的高收益特徵。

- 電子零組件業

  - 當日平均報酬率為5.70%，隨著持有期延長，一個月的平均報酬率達到9.58%。這反映出該行業在短期內具備一定的增值空間。

- 電腦及週邊設備業

  - 當日報酬率約為4.88%，半年持有期報酬率提升至15.10%，顯示出較強的長期持有收益。

- 生技醫療業

  - 當日平均報酬率為3.54%，長期持有（一季和半年）的報酬率分別為10.75%和6.91%。此行業顯示出穩健的增長潛力。

- 半導體業

  - 該行業的一週平均報酬率最高，達到4.62%，但持有期延長至一季和半年後，報酬率分別下降至-1.92%和-8.36%，顯示出短期持有的優勢。

- 觀光餐旅業

  - 當日平均報酬率為15.31%，但半年持有期的報酬率降至-8.41%，表明該行業適合短期投資而非長期持有。

- 電子通路業

  -當日平均報酬率為6.73%，一週內上升至7.70%，但半年持有期報酬率顯著下降至-17.98%，顯示出短期內收益較高，長期持有風險較大。

- 食品工業

  - 當日報酬率為-51%，顯示出顯著的負面表現；一個月和半年內，報酬率均為負，且波動性大，表明該行業風險較高。

- 橡膠工業

  - 當日報酬率為-1.78%，半年報酬率為-6.06%，整體表現不佳，波動性大，標準差高達11.01%。

- 金融保險業

  - 當日平均報酬率為0.90%，一個月內報酬率為0.99%，顯示出相對穩定的增長，半年內報酬率為8.89%。

- 光電業

  - 當日平均報酬率為0.46%，但長期持有並未顯示出顯著增長，一個月報酬率為4.55%，但半年內僅有1.99%。

- 化學工業

  - 當日平均報酬率為1.71%，半年內報酬率為0.49%，該行業的長期持有收益較為穩定，但增長有限。

- 航運業

  - 當日平均報酬率為0.71%，但一周報酬率轉為負，半年的報酬率回升至5.92%，顯示出短期波動較大，長期收益尚可。

- 電器電纜

  - 當日報酬率為11.41%，但一週報酬率下降，長期持有回報不穩定，一個月和半年內均顯示負報酬。

- 建材營造

  - 當日報酬率接近於零，半年內報酬率為7.41%，該行業在長期持有中顯示出一定的增值潛力。

- 化工業

  - 當日報酬率為-9.53%，半年內報酬率為-3.94%，表現不佳。

- 結論
 - 從本研究的回測結果可得出以下結論：

   不同行業的IPO股票在不同持有期內的收益和風險顯著不同。電子零組件業、電腦及週邊設備業和資訊服務業在長期持有中顯示出較高的收益，而觀光餐旅業和電子通路業則在短期內表現更佳。

   數據顯示出波動性較大的行業在短期投資中可能更具吸引力，而穩定增長的行業則適合長期投資策略。

   投資者應根據行業特性及市場情況調整投資持有期，以達到最佳收益。
